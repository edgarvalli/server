(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{294:function(e,t,n){e.exports=n(569)},458:function(e,t){},460:function(e,t){},495:function(e,t){},496:function(e,t){},541:function(e,t){var n,a;"undefined"!==typeof document.hidden?(n="hidden",a="visibilitychange"):"undefined"!==typeof document.mozHidden?(n="mozHidden",a="mozvisibilitychange"):"undefined"!==typeof document.msHidden?(n="msHidden",a="msvisibilitychange"):"undefined"!==typeof document.webkitHidden&&(n="webkitHidden",a="webkitvisibilitychange"),document.addEventListener(a,function(){document[n]||navigator.userAgent.includes("mobile")&&window.location.reload()},!1)},564:function(e,t){},567:function(e,t,n){},569:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(30),s=n.n(i),c=n(19),o=n(20),l=n(22),u=n(21),m=n(23),d=n(1),p=localStorage.getItem("session")||sessionStorage.getItem("session"),h=JSON.parse(p),f="ckUQU!@YtN%8Phtp9tXtC6W96PeV8Kd4mcMpB==Bs9JUK8B=*JKNX!C$K%3a",g="https://ev-server.ddns.net",v=g+"/api/tlacrm",b="https://lh3.googleusercontent.com/-zjdfJx44dfQ/AAAAAAAAAAI/AAAAAAAAAos/SukJQdVUzJU/s60-p-rw-no-il/photo.jpg",E="https://ev-server.ddns.net/tlacrm/images/profiles/default_avatar.png",y=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={openDrawer:!1,params:{onSearch:function(e){return console.log(e)},child:!1,parentView:"",title:"Navbar"},credentials:""},n.toggleDrawer=function(){return n.setState({openDrawer:!n.state.openDrawer})},n.showSearchBar=function(){var e=document.querySelector("#search-bar-container"),t=document.querySelector("#search-bar");e.classList.contains("search-bar-show")?(e.classList.remove("search-bar-show"),n.state.params.onSearch("")):(e.classList.add("search-bar-show"),t.focus())},n.setParams=function(e){return n.setState({params:e})},n}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){"credentials"in navigator?this.setState({credentials:"Credentials API is supported"}):this.setState({credentials:"Credentials API is not supported"})}},{key:"changeView",value:function(e){this.props.navigation.go(e),this.toggleDrawer()}},{key:"logout",value:function(){window.confirm("\xbfDeseas cerrar sesi\xf3n?")?(localStorage.clear(),sessionStorage.clear(),window.location.reload()):this.toggleDrawer()}},{key:"toggleFullScreen",value:function(){document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen()}},{key:"mainBar",value:function(){var e=this,t=this.state.params.onSearch,n=localStorage.getItem("modules")||sessionStorage.getItem("modules");return n=JSON.parse(n),r.a.createElement("div",null,r.a.createElement(d.a,{position:"fixed"},r.a.createElement(d.w,{className:"navbar"},r.a.createElement(d.n,{onClick:this.toggleDrawer},"menu"),r.a.createElement(d.x,{variant:"h6",color:"inherit"},this.state.params.title),r.a.createElement(d.n,{onClick:this.showSearchBar},"search"),r.a.createElement("div",{className:"search-bar",id:"search-bar-container"},r.a.createElement(d.n,{color:"action",onClick:this.showSearchBar},"arrow_back"),r.a.createElement("input",{type:"search",id:"search-bar",placeholder:this.state.params.placeholder||"Buscador",autoComplete:"off",onChange:function(e){return t(e.target.value)}})))),r.a.createElement(d.t,{open:this.state.openDrawer,onClose:this.toggleDrawer,onOpen:this.toggleDrawer},r.a.createElement(d.o,null,r.a.createElement(d.p,null,r.a.createElement(d.q,null,r.a.createElement(d.b,{src:b})),r.a.createElement(d.s,null,"Edgar Eduardo Valli Mu\xf1oz"))),r.a.createElement(d.j,null),r.a.createElement(d.o,{className:"w-drawer"},n.map(function(t){return r.a.createElement(d.p,{onClick:function(){return e.changeView(t.reactPath)},key:t.key},t.display)}),r.a.createElement(d.p,{onClick:function(){return e.logout()}},"Cerrar Session"),r.a.createElement(d.p,{onClick:function(){return e.toggleFullScreen()}},"FullScreen"),r.a.createElement(d.p,null,r.a.createElement(d.x,{variant:"caption"},this.state.credentials)))))}},{key:"childBar",value:function(){var e=this,t=this.state.params,n=t.parentView,a=t.title,i=this.props.navigation;return r.a.createElement("div",null,r.a.createElement(d.a,null,r.a.createElement(d.w,{className:"navbar"},r.a.createElement(d.n,{onClick:function(){console.log(e.state.params),i.go(n,e.state.params.params)}},"arrow_back"),r.a.createElement(d.x,{variant:"h6",color:"inherit"},a),r.a.createElement("div",null))))}},{key:"render",value:function(){return this.state.params.child?this.childBar():this.mainBar()}}]),t}(a.Component),k=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={display:"fixed",title:""},n.setVisible=function(e){return n.setState({display:"fixed",title:e})},n.setHide=function(){return n.setState({display:"none"})},n}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.state,t=e.display,n=e.title;return r.a.createElement("div",{className:"loader",style:{display:t}},r.a.createElement(d.h,{variant:"indeterminate",color:"primary"}),r.a.createElement(d.x,{variant:"caption",style:{marginLeft:20}},n||"Cargando..."))}}]),t}(a.Component),w=n(84),x=n(6),C=n.n(x),O=n(13),S=n(131),j=n.n(S),N=function(e){var t=e,n=v+"/users/login",a=localStorage.getItem("session")||sessionStorage.getItem("session"),r={headers:{"Content-Type":"Application/Json",Accept:"Application/Json"},method:"get"};return a&&(a=JSON.parse(a),r.headers.Token=a.token),{authentication:function(){var e=Object(O.a)(C.a.mark(function e(t,a){var i,s,c;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.method="post",r.body=JSON.stringify(t),e.next=4,fetch(n,r).catch(function(e){return console.log(e)});case 4:return i=e.sent,e.next=7,i.json();case 7:return(s=e.sent).error&&alert("Error: "+s.message),s.error||(a?(c=new j.a(f),localStorage.setItem("loggedIn",!0),localStorage.setItem("currentView","Clients"),localStorage.setItem("session",JSON.stringify({username:t.username,password:c.encrypt(t.password),token:s.token,autoLogin:!0})),localStorage.setItem("modules",JSON.stringify(s.user.profile.modules))):(sessionStorage.setItem("loggedIn",!0),sessionStorage.setItem("currentView","Clients"),sessionStorage.setItem("session",JSON.stringify({token:s.token})),sessionStorage.setItem("modules",JSON.stringify(s.user.profile.modules)))),e.abrupt("return",s);case 11:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),loginAgain:function(){var e=Object(O.a)(C.a.mark(function e(){var t,i,s,c;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new j.a(f),i={username:a.username,password:t.decrypt(a.password)},r.method="post",r.body=JSON.stringify(i),e.next=6,fetch(n,r).catch(function(e){return console.log(e)});case 6:return s=e.sent,e.next=9,s.json();case 9:if(!(c=e.sent).error){e.next=12;break}return e.abrupt("return",alert("Autologin error: "+c.message));case 12:a.token=c.token,localStorage.setItem("session",JSON.stringify(a));case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),get:function(){var e=Object(O.a)(C.a.mark(function e(){var n,i;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,r).catch(function(e){return console.log(e)});case 2:return n=e.sent,e.next=5,n.json();case 5:if(!(i=e.sent).error){e.next=17;break}if(!i.tokenExpired){e.next=17;break}if(!a.autoLogin){e.next=17;break}return e.next=11,this.loginAgain();case 11:return e.next=13,fetch(t,r).catch(function(e){return console.log(e)});case 13:return n=e.sent,e.next=16,n.json();case 16:i=e.sent;case 17:return e.abrupt("return",i);case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),post:function(){var e=Object(O.a)(C.a.mark(function e(n){var i,s;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.method="post",r.body=JSON.stringify(n),e.next=4,fetch(t,r).catch(function(e){return console.log(e)});case 4:return i=e.sent,e.next=7,i.json();case 7:if(!(s=e.sent).error){e.next=19;break}if(!s.tokenExpired){e.next=19;break}if(!a.autoLogin){e.next=19;break}return e.next=13,this.loginAgain();case 13:return e.next=15,fetch(t,r).catch(function(e){return console.log(e)});case 15:return i=e.sent,e.next=18,i.json();case 18:s=e.sent;case 19:return e.abrupt("return",s);case 20:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),uploadFile:function(){var e=Object(O.a)(C.a.mark(function e(n,i,s){var c,o;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(v,"/").concat(n.toLowerCase(),"/uploadfiles/"),r.method="post",r.headers.data=JSON.stringify(i),delete r.headers["Content-Type"],r.body=s,e.next=7,fetch(t,r).catch(function(e){return console.log(e)});case 7:return c=e.sent,e.next=10,c.json();case 10:if(!(o=e.sent).error){e.next=22;break}if(!o.tokenExpired){e.next=22;break}if(!a.autoLogin){e.next=22;break}return e.next=16,this.loginAgain();case 16:return e.next=18,fetch(t,r).catch(function(e){return console.log(e)});case 18:return c=e.sent,e.next=21,c.json();case 21:o=e.sent;case 22:return e.abrupt("return",o);case 23:case"end":return e.stop()}},e,this)}));return function(t,n,a){return e.apply(this,arguments)}}(),addChild:function(){var e=Object(O.a)(C.a.mark(function e(n,a){var r;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(v,"/").concat(n.toLowerCase(),"/add/"),e.next=3,this.post(a);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),updateChild:function(){var e=Object(O.a)(C.a.mark(function e(n,a){var r;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(v,"/").concat(n.toLowerCase(),"/update/"),e.next=3,this.post(a);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),removeChild:function(){var e=Object(O.a)(C.a.mark(function e(n,a){var r;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(v,"/").concat(n.toLowerCase(),"/remove/").concat(a),e.next=3,this.get();case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),searchChild:function(){var e=Object(O.a)(C.a.mark(function e(n,a){var r;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(v,"/").concat(n.toLowerCase(),"/search/").concat(a),e.next=3,this.get();case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),fetchChildrens:function(){var e=Object(O.a)(C.a.mark(function e(n){var a,r,i=arguments;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.length>1&&void 0!==i[1]?i[1]:1,t="".concat(v,"/").concat(n.toLowerCase(),"/fetch/").concat(a),e.next=4,this.get();case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),getChild:function(){var e=Object(O.a)(C.a.mark(function e(n,a){var r;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(v,"/").concat(n.toLowerCase(),"/getone/").concat(a),e.next=3,this.get();case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()}},A=y,I=k,D=function(e){var t=r.a.useState(e.budget.budgetDescription||""),n=Object(w.a)(t,2),a=n[0],i=n[1],s=r.a.useState(!1),c=Object(w.a)(s,2),o=c[0],l=c[1],u=r.a.useState(e.budget.visited||!1),m=Object(w.a)(u,2),p=m[0],h=m[1],f=function(){return r.a.createElement(d.e,{className:"card-action__center"},r.a.createElement(d.c,{color:"default",disabled:p},p?"Visitado":"Sin Visitar"),r.a.createElement(d.c,{color:"primary",onClick:function(){e.navigation.go("BudgetComments",{budget:e.budget})}},"Comentarios"),r.a.createElement(d.c,{color:"primary",onClick:function(){return l(!0)}},"Editar"))},g=function(){return r.a.createElement(d.e,{className:"card-action__right"},r.a.createElement(d.c,{variant:"contained",color:"primary",onClick:function(){N().updateChild("budgets",{id:e.budget._id,budget:{budgetDescription:a,visited:p}}),l(!1)}},"Guardar"))};return r.a.createElement(d.d,null,r.a.createElement(d.f,null,r.a.createElement(d.o,null,r.a.createElement(d.p,null,r.a.createElement(d.q,null,r.a.createElement(d.b,{src:E})),r.a.createElement(d.s,{secondary:new Date(e.budget.createDate).toLocaleString("es-MX")},r.a.createElement(d.x,{paragraph:!0},e.budget.clientName))),r.a.createElement(d.p,null,r.a.createElement(d.s,null,o?r.a.createElement("div",null,r.a.createElement(d.v,{label:"Editar informaci\xf3n del presupuesto",value:a,rows:"4",variant:"outlined",multiline:!0,fullWidth:!0,onChange:function(e){var t=e.target;return i(t.value)}}),r.a.createElement(d.l,{label:"Visitado",control:r.a.createElement(d.u,{value:"visited",onChange:function(e){var t=e.target;return h(t.checked)},color:"primary",checked:p})})):r.a.createElement(d.m,{container:!0},r.a.createElement(d.m,{item:!0,xs:12},r.a.createElement(d.x,{paragraph:!0},a.split("\n").map(function(e,t){return r.a.createElement("span",{key:e+t},e," ",r.a.createElement("br",null))})))))))),r.a.createElement(function(){return o?r.a.createElement(g,null):r.a.createElement(f,null)},null))},V=function(e){var t=e.date?new Date(e.date):new Date;return t=t.toLocaleString("es-MX"),r.a.createElement(d.o,null,r.a.createElement(d.p,null,r.a.createElement(d.q,null,r.a.createElement(d.b,{src:e.avatarUri})),r.a.createElement(d.s,{secondary:t},r.a.createElement(d.x,null,e.clientName))))},P=(n(541),Object(O.a)(C.a.mark(function e(){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!("serviceWorker"in navigator)){e.next=6;break}return e.next=3,navigator.serviceWorker.register("sw.js",{scope:"/tlacrm/"}).catch(function(e){return console.log("Error when try to register service worker, ".concat(e))});case 3:window.reg=e.sent,e.next=7;break;case 6:alert("Service Worker is not supported");case 7:case"end":return e.stop()}},e,this)}))),_=n(233),B="BH54HR9NEeTIQ36JskmMCoKMsM1EseYPAEv7O575VrgJ9xtXW3gh8nVO23PVwNWB8CDUCypLRBGU9jCiXkQVUZY",J=function(){var e="=".repeat((4-B.length%4)%4),t=(B+e).replace(/_/g,"/"),n=window.atob(t);return Uint8Array.from(Object(_.a)(n).map(function(e){return e.charCodeAt(0)}))};function L(){return M.apply(this,arguments)}function M(){return(M=Object(O.a)(C.a.mark(function e(){var t,n,a;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=J(),n="https://ev-server.ddns.net/api/tlacrm/users/subscribe",e.next=4,window.reg.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:t}).catch(function(e){return console.log("Error to subscribe to push manager ".concat(e))});case 4:return a=e.sent,e.next=7,fetch(n,{headers:{"Content-Type":"Application/Json"},method:"post",body:JSON.stringify(a)});case 7:window.location.reload();case 8:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var q=P,U=Object(O.a)(C.a.mark(function e(){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:"Notification"in window&&Notification.requestPermission().then(function(e){"granted"===e&&L()}).catch(function(e){return console.log("Error to request notification ".concat(e))});case 1:case"end":return e.stop()}},e,this)})),W=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={username:"",password:"",autoLogin:!1},n}return Object(m.a)(t,e),Object(o.a)(t,[{key:"login",value:function(){var e=Object(O.a)(C.a.mark(function e(t){var n,a,r,i;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=this.state,a=n.username,r=n.password,i=n.autoLogin,"https://ev-server.ddns.net/api/tlacrm/users/login",e.next=5,N("https://ev-server.ddns.net/api/tlacrm/users/login").authentication({username:a,password:r},i);case 5:e.sent.error||Notification.requestPermission().then(function(){var e=Object(O.a)(C.a.mark(function e(t){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("granted"!==t){e.next=3;break}return e.next=3,U();case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement("form",{onSubmit:function(t){return e.login(t)},className:"login-container"},r.a.createElement("div",{className:"bg-login"}),r.a.createElement(d.d,null,r.a.createElement(d.g,null),r.a.createElement(d.f,null,r.a.createElement(d.v,{label:"Usuario",fullWidth:!0,value:this.state.username,onChange:function(t){return e.setState({username:t.target.value})},tabIndex:1}),r.a.createElement(d.v,{label:"Contrase\xf1a",type:"password",fullWidth:!0,value:this.state.password,onChange:function(t){return e.setState({password:t.target.value})},tabIndex:2})),r.a.createElement(d.e,null,r.a.createElement(d.m,{container:!0},r.a.createElement(d.m,{item:!0,xs:3}),r.a.createElement(d.m,{item:!0,xs:6},r.a.createElement(d.l,{control:r.a.createElement(d.u,{value:!0,color:"primary",onChange:function(t){return e.setState({autoLogin:t.target.checked})}}),label:"Auto Login",tabIndex:3})),r.a.createElement(d.m,{item:!0,xs:3}),r.a.createElement(d.m,{item:!0,xs:12},r.a.createElement(d.c,{fullWidth:!0,variant:"contained",color:"primary",type:"submit"},"Login"))))))}}]),t}(a.Component),F=function(e){return e.clients.map(function(t){return r.a.createElement(d.o,{key:t._id},r.a.createElement(d.p,{onClick:function(){return e.onExpanded(t._id)},className:"touchable"},r.a.createElement(d.q,null,r.a.createElement(d.b,{src:t.avatarUri||E})),r.a.createElement(d.s,{secondary:t.cellphone||""},t.name),r.a.createElement(d.r,null,r.a.createElement(d.n,{style:{transition:"all .5s"},id:"icon-"+t._id},"keyboard_arrow_down"))),r.a.createElement(H,Object.assign({client:t},e)))})},H=function(e){var t=e.client,n=e.navigation,a=e.onRefresh,i=e.expanded;return r.a.createElement(d.i,{timeout:"auto",unmountOnExit:!0,in:i[t._id]||!1},r.a.createElement(d.o,null,["Llamar","Detalles","Mostrar Presupuestos","Mostrar Trabajos","Eliminar"].map(function(e,i){return r.a.createElement(d.p,{key:e+i,className:"active"},r.a.createElement(d.x,{variant:"caption",onClick:function(){return function(e){switch(e){case 0:window.location.href="tel:+".concat(t.cellphone);break;case 1:n.go("ClientForm",{action:"update",id:t._id});break;case 2:case 3:break;case 4:window.confirm("\xbfDeseas eliminar el registro (Se eliminaran todos los trabajos y presupuestos relacionados)?")&&N().removeChild("clients",t._id).then(function(e){if(e.error)return alert(e.message);a()});break;default:return null}}(i)},className:"touchable"},e))})))},T=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={clients:[],expanded:{}},n}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.navigation.setNavbarParams({title:"Clientes",placeholder:"Buscar Cliente",onSearch:function(t){return e.searchClients(t)},onRefresh:function(){return e.fetchClients()}}),this.fetchClients()}},{key:"fetchClients",value:function(){var e=Object(O.a)(C.a.mark(function e(){var t;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.refs.loader.setVisible(),e.next=3,N().fetchChildrens("clients");case 3:t=e.sent,this.setState({clients:t.data.clients}),this.refs.loader.setHide();case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"searchClients",value:function(){var e=Object(O.a)(C.a.mark(function e(t){var n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t){e.next=2;break}return e.abrupt("return",this.fetchClients());case 2:return e.next=4,N().searchChild("clients",t);case 4:if(!(n=e.sent).error){e.next=7;break}return e.abrupt("return",alert(n.message));case 7:this.setState({clients:n.data.clients});case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"container"},r.a.createElement(I,{ref:"loader"}),r.a.createElement(d.m,{container:!0},r.a.createElement(d.m,{item:!0,xs:12},r.a.createElement(d.o,{component:"nav"},r.a.createElement(F,{clients:this.state.clients,navigation:this.props.navigation,onRefresh:function(){return e.fetchClients()},expanded:this.state.expanded,onExpanded:function(t){var n=e.state.expanded;n[t]=!e.state.expanded[t],e.setState({expanded:n})}})))),r.a.createElement("span",{className:"fab-fixed"},r.a.createElement(d.k,{color:"primary","aria-label":"Add",onClick:function(){return e.props.navigation.go("ClientForm")}},r.a.createElement(d.n,null,"add"))))}}]),t}(a.Component),z=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).clientAttributes=[{name:"name",type:"text",label:"Nombre",required:!0},{name:"cellphone",label:"Celular",type:"tel",required:!0},{name:"phone",label:"Telefono",type:"tel"},{name:"address",label:"Direcci\xf3n"},{name:"hood",label:"Colonia"},{name:"county",label:"Municipio"},{name:"state",label:"Estado"},{name:"country",label:"Pais"},{name:"zip",label:"Codigo Postal",type:"number"}],n.invoiceAttributes=[{name:"rfc",label:"RFC"},{name:"forma_de_pago",label:"Forma de Pago"},{name:"uso_de_factura",label:"Uso de factura"}],n.state={values:{}},n}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.navigation;e.setNavbarParams({child:!0,parentView:"Clients",title:"Datos Clientes"}),"update"===e.getParams().action&&this.getValues(e.getParams().id)}},{key:"getValues",value:function(){var e=Object(O.a)(C.a.mark(function e(t){var n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.refs.loader.setVisible(),e.next=3,N().getChild("clients",t);case 3:if(!(n=e.sent).error){e.next=6;break}return e.abrupt("return",alert(n.message));case 6:delete n.data._id,this.setState({values:n.data}),this.refs.loader.setHide();case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleSubmit",value:function(e){e.preventDefault(),"update"===this.props.navigation.getParams().action?this.updateClient():this.addClient()}},{key:"updateClient",value:function(){var e=Object(O.a)(C.a.mark(function e(){var t,n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.state.values,e.next=4,N().updateChild("clients",{id:this.props.navigation.getParams().id,client:t});case 4:if(!(n=e.sent).error){e.next=7;break}return e.abrupt("return",alert(n.message));case 7:this.props.navigation.go("Clients"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}},e,this,[[0,10]])}));return function(){return e.apply(this,arguments)}}()},{key:"addClient",value:function(){var e=Object(O.a)(C.a.mark(function e(){var t,n,a;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.state.values,n="".concat(v,"/clients/add"),e.next=5,N(n).post(t);case 5:if(!(a=e.sent).error){e.next=8;break}return e.abrupt("return",alert(a.message));case 8:this.props.navigation.go("Clients"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}},e,this,[[0,11]])}));return function(){return e.apply(this,arguments)}}()},{key:"handleChange",value:function(e,t){var n=this.state.values;n[e]=t,this.setState({values:n})}},{key:"render",value:function(){var e=this,t=this.props.navigation;return r.a.createElement("div",{className:"container padding-1 margin-1"},"update"===t.getParams().action&&r.a.createElement(I,{ref:"loader"}),r.a.createElement("form",{onSubmit:function(t){return e.handleSubmit(t)}},r.a.createElement(d.m,{container:!0,spacing:16},r.a.createElement(d.m,{item:!0,xs:12},this.clientAttributes.map(function(t,n){return r.a.createElement(d.v,{key:t.name+n,name:t.name,id:t.name,label:t.label,fullWidth:!0,type:t.type||"text",required:t.required||!1,tabIndex:1,autoComplete:t.autoComplete||"off",value:e.state.values[t.name]||"",onChange:function(n){var a=n.target;return e.handleChange(t.name,a.value)}})})),r.a.createElement(d.m,{item:!0,xs:12},r.a.createElement(d.l,{control:r.a.createElement(d.u,{checked:this.state.values.invoiceInfo||!1,color:"primary",value:"invoiceInfo",onChange:function(t){var n=t.target;return e.handleChange("invoiceInfo",n.checked)}}),label:"Datos de factura",tabIndex:1})),r.a.createElement(d.m,{item:!0,xs:12},this.state.values.invoiceInfo&&this.invoiceAttributes.map(function(t,n){return r.a.createElement(d.v,{key:t.name+n,name:t.name,id:t.name,label:t.label,fullWidth:!0,type:t.type||"text",required:t.required||!1,tabIndex:1,autoComplete:t.autoComplete||"off",value:e.state.values[t.name]||"",onChange:function(n){var a=n.target;return e.handleChange(t.name,a.value)}})})),r.a.createElement(d.m,{xs:12,item:!0},r.a.createElement(d.c,{variant:"contained",color:"primary",fullWidth:!0,type:"submit"},"Enviar")))))}}]),t}(a.Component),K=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={budgets:[]},n}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.navigation.setNavbarParams({title:"Presupuestos"}),this.fetchBudgets(),document.body.style.background="#e1e1e1"}},{key:"componentWillUnmount",value:function(){document.body.style.background="#ffffff"}},{key:"fetchBudgets",value:function(){var e=this;N().fetchChildrens("budgets").then(function(t){if(t.error)return alert(t.message);e.setState({budgets:t.data.budgets})})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"container",style:{padding:".2rem"}},r.a.createElement(d.m,{container:!0,spacing:16,style:{marginBottom:"3rem"}},this.state.budgets.map(function(t){return r.a.createElement(d.m,{item:!0,xs:12,key:t._id},r.a.createElement(D,{budget:t,navigation:e.props.navigation}))})),r.a.createElement("span",{className:"fab-fixed"},r.a.createElement(d.k,{color:"primary","aria-label":"Add",onClick:function(){return e.props.navigation.go("SelectClient",{parentView:"Budgets",childView:"AddBudget"})}},r.a.createElement(d.n,null,"add"))))}}]),t}(a.Component),R=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={budgets:[],values:{}},n.files=new FormData,n}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.navigation,t=e.setNavbarParams,n=e.getParams;t({title:"Agregar Presupuestos",child:!0,parentView:"SelectClient",params:{parentView:"Budgets",childView:"AddBudget"}}),this.setState({values:{clientId:n()._id,clientName:n().name,clientCellphone:n().cellphone,budgetDescription:""}})}},{key:"render",value:function(){var e=this,t=this.state.values;return r.a.createElement("div",{className:"container"},r.a.createElement(V,{avatarUri:E,clientName:t.clientName}),r.a.createElement("textarea",{className:"add-budget",rows:"4",placeholder:"Agregar Informaci\xf3n del presupuesto",required:!0,value:t.budgetDescription,onChange:function(n){var a=n.target;t.budgetDescription=a.value,e.setState({values:t})},ref:"textbox"}),r.a.createElement("div",{className:"fab-fixed"},r.a.createElement(d.k,{"ev-target":"add",color:"primary",onClick:function(){""!==t.budgetDescription?N().addChild("budgets",t).then(function(t){if(t.error)return alert(t.message);e.props.navigation.go("Budgets")}):alert("Debe de llenar la informaci\xf3n solicitada")}},r.a.createElement(d.n,null,"check"))))}}]),t}(a.Component),X=n(232),Q=n.n(X),Y=function(e){return r.a.createElement(d.m,{container:!0,spacing:0},r.a.createElement(d.m,{item:!0,xs:12},r.a.createElement(V,{avatarUri:E,clientName:e.username,date:e.createDate||""})),r.a.createElement(d.m,{item:!0,xs:2}),r.a.createElement(d.m,{item:!0,xs:10},r.a.createElement(d.x,{paragraph:!0},e.comment.split("\n").map(function(e,t){return r.a.createElement("span",{key:e+t},e,r.a.createElement("br",null))}))))},G=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).socket=Q()(g+"/tlacrm",{query:{room:n.props.navigation.getParams().budget._id,token:h.token}}),n.handleTyping="",n.state={typing:"",budget:{comments:[],budgetDescription:""},comment:""},n.budget=n.props.navigation.getParams().budget,n.componentWillUnmount=function(){return document.body.style.background="#fffff"},n}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.navigation.setNavbarParams({child:!0,title:"Prospectos",parentView:"Budgets"}),document.body.style.background="#e1e1e1",this.socketEvents(),N().getChild("budgets",this.budget._id).then(function(t){e.setState({budget:t.data.budget})})}},{key:"socketEvents",value:function(){var e=this;this.socket.on("client_typing",function(t){e.setState({typing:t.user+" is typing..."})}),this.socket.on("client_stop_typing",function(){return e.setState({typing:""})})}},{key:"addComment",value:function(){var e=this.state,t=e.budget,n=e.comment,a=t._id;t.comments.push({comment:n,username:"Edgar Valli"}),this.setState({budget:t,comment:""}),delete t._id,this.socket.emit("add_commnet",{id:a,budget:t})}},{key:"render",value:function(){var e=this,t=this.state.budget;return r.a.createElement("div",{className:"container comments"},r.a.createElement(d.o,null,r.a.createElement(d.p,null,r.a.createElement(d.q,null,r.a.createElement(d.b,{src:E})),r.a.createElement(d.s,{secondary:new Date(t.createDate).toLocaleString()},r.a.createElement(d.x,{variant:"title"},t.clientName)))),r.a.createElement("div",{className:"main-comment"},r.a.createElement(d.x,{paragraph:!0},t.budgetDescription.split("\n").map(function(e,t){return r.a.createElement("span",{key:e+t},e,r.a.createElement("br",null))}))),r.a.createElement("div",{className:"comments-container",ref:"comments"},r.a.createElement(d.x,{variant:"caption",style:{marginLeft:"1rem"}},this.state.typing),t.comments.map(function(e,t){return r.a.createElement("div",{key:e.username+t},r.a.createElement(Y,{username:e.username,comment:e.comment}),r.a.createElement(d.j,null))})),r.a.createElement("div",{className:"comment-box"},r.a.createElement(d.b,{src:b}),r.a.createElement("textarea",{type:"text",placeholder:"Escribe tu comentario",value:this.state.comment,onFocus:function(){setTimeout(function(){window.scrollTo(0,document.body.scrollHeight)},200)},onChange:function(t){var n=t.target;e.setState({comment:n.value}),e.socket.emit("client_typing",{user:"Edgar Valli",value:n.value}),clearInterval(e.handleTyping),n.value&&(e.handleTyping=setTimeout(function(){e.socket.emit("client_stop_typing")},500))}}),r.a.createElement(d.n,{onClick:function(){return e.addComment()}},"send")))}}]),t}(a.Component),Z=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={clients:[]},n.params=n.props.navigation.getParams(),n}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.navigation.setNavbarParams({title:"Selecciona un cliente",child:!0,parentView:this.params.parentView}),this.fetchClients()}},{key:"fetchClients",value:function(){var e=this;this.refs.loader.setVisible(),N().fetchChildrens("clients").then(function(t){if(t.error)return alert(t.message);e.setState({clients:t.data.clients}),e.refs.loader.setHide()})}},{key:"searchClient",value:function(e){var t=this;this.refs.loader.setVisible(),N().searchChild("clients",e).then(function(e){if(e.error)return alert(e.message);t.setState({clients:e.data.clients}),t.refs.loader.setHide()})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"container"},r.a.createElement(I,{ref:"loader"}),r.a.createElement(d.m,{container:!0,spacing:16},r.a.createElement(d.m,{item:!0,xs:12,style:{padding:"1rem"}},r.a.createElement(d.v,{variant:"standard",type:"search",label:"Buscar Cliente",fullWidth:!0,onChange:function(t){var n=t.target;""===n.value?e.fetchClients():e.searchClient(n.value)}})),r.a.createElement(d.m,{item:!0,xs:12},r.a.createElement(d.o,null,this.state.clients.map(function(t){return r.a.createElement(d.p,{key:t._id,onClick:function(){e.props.navigation.go(e.params.childView,t)}},r.a.createElement(d.s,{secondary:t.cellphone||""},t.name),r.a.createElement(d.r,null,r.a.createElement(d.n,null,"next")))})))))}}]),t}(a.Component),$=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={users:[]},n}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=Object(O.a)(C.a.mark(function e(){var t;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.props.navigation.setNavbarParams({title:"Clientes"}),e.next=3,N().fetchChildrens("users");case 3:(t=e.sent).error||this.setState({users:t.data.users});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",{className:"container"},r.a.createElement(d.o,null,this.state.users.map(function(e){return r.a.createElement(d.p,{key:e._id},r.a.createElement(d.q,null,r.a.createElement(d.b,{src:e.avatar})),r.a.createElement(d.s,{secondary:e.username},r.a.createElement(d.x,null,e.name)))})))}}]),t}(a.Component),ee=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.navigation.setNavbarParams({title:"Clientes"})}},{key:"render",value:function(){return r.a.createElement("div",{className:"container"},"Trabajos")}}]),t}(a.Component),te=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={views:{Login:W,Clients:T,ClientForm:z,Budgets:K,AddBudget:R,SelectClient:Z,BudgetComments:G,Jobs:ee,Users:$},currentView:"AddBudget",params:{},loggedIn:!1,isMobile:!1},n}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){this.breakPoints(),"true"===(localStorage.getItem("loggedIn")||sessionStorage.getItem("loggedIn"))?this.setState({loggedIn:!0,currentView:localStorage.getItem("currentView")}):this.setState({loggedIn:!1})}},{key:"breakPoints",value:function(){var e=window.innerWidth;/Mobile/.test(navigator.userAgent)?this.setState({isMobile:!0}):e>768&&this.setState({isMobile:!0})}},{key:"render",value:function(){var e=this,t=this.state,n=t.views,a=t.currentView,i=t.isMobile,s=n[a],c={go:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};localStorage.getItem("currentView")?(localStorage.setItem("currentView",t),localStorage.setItem("params",JSON.stringify(n))):(sessionStorage.setItem("currentView",t),sessionStorage.setItem("params",JSON.stringify(n))),e.setState({currentView:t,params:n})},setNavbarParams:function(t){return e.refs.navbar.setParams(t)},isMobile:i,getParams:function(){var e={};return e=localStorage.getItem("params")?localStorage.getItem("params"):sessionStorage.getItem("params"),JSON.parse(e)}};return this.state.loggedIn?r.a.createElement("div",null,r.a.createElement(A,{ref:"navbar",navigation:c}),r.a.createElement(s,{navigation:c})):r.a.createElement(W,null)}}]),t}(a.Component);n(567);q(),s.a.render(r.a.createElement(te,null),document.getElementById("root"))}},[[294,2,1]]]);
//# sourceMappingURL=main.db37d872.chunk.js.map