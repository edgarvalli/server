(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{328:function(e,t,a){e.exports=a(609)},499:function(e,t){},501:function(e,t){},536:function(e,t){},537:function(e,t){},604:function(e,t){},607:function(e,t,a){},608:function(e,t){var a,n;"undefined"!==typeof document.hidden?(a="hidden",n="visibilitychange"):"undefined"!==typeof document.mozHidden?(a="mozHidden",n="mozvisibilitychange"):"undefined"!==typeof document.msHidden?(a="msHidden",n="msvisibilitychange"):"undefined"!==typeof document.webkitHidden&&(a="webkitHidden",n="webkitvisibilitychange"),document.addEventListener(n,function(){document[a]||navigator.userAgent.includes("mobile")&&window.location.reload()},!1)},609:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(34),s=a.n(i),c=a(14),o=a(15),l=a(17),u=a(16),m=a(18),p=a(63),d=a(1),h=a(44),g=a(51),f=localStorage.getItem("session")||sessionStorage.getItem("session"),v=(JSON.parse(f),"https://ev-server.ddns.net"),b=v+"/api/tlacrm",E="BH54HR9NEeTIQ36JskmMCoKMsM1EseYPAEv7O575VrgJ9xtXW3gh8nVO23PVwNWB8CDUCypLRBGU9jCiXkQVUZY",y=a(616),x=Object(y.a)({root:{padding:"2px 4px",display:"flex",alignItems:"center",width:"100%",height:"3.5rem"},input:{marginLeft:8,flex:1},divider:{width:1,height:28,margin:4}}),w=function(e){var t=x();return r.a.createElement(d.y,{className:t.root},r.a.createElement(d.q,{onClick:e.onDrawerIconClick},"menu"),r.a.createElement(d.r,{className:t.input,placeholder:e.placeholder||"Buscar",onChange:function(t){return e.onSearch(t)},inputProps:{"aria-label":"Search Google Maps"}}),r.a.createElement(d.q,null,"search"),r.a.createElement(d.m,{className:t.divider}),r.a.createElement(d.q,null,"more_vert"))},k=localStorage;null===k.getItem("user")&&(k=sessionStorage);var C=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).user=JSON.parse(k.getItem("user")),a.state={toggleDrawer:!1},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this,t=this.state.toggleDrawer,a=this.props,n=a.params,i=a.navigation;return r.a.createElement("div",{className:"navbar-container"},r.a.createElement(w,{onDrawerIconClick:function(){return e.setState({toggleDrawer:!0})},placeholder:n.placeholder,onSearch:function(e){return n.onSearch(e.target.value)}}),r.a.createElement(d.A,{open:t,onClose:function(){return e.setState({toggleDrawer:!1})},onOpen:function(){return e.setState({toggleDrawer:!0})}},r.a.createElement("div",{className:"w-drawer"},r.a.createElement(d.s,null,r.a.createElement(d.t,null,r.a.createElement(d.u,null,r.a.createElement(d.b,{src:b+"/get-avatar/"+this.user._id})),r.a.createElement(d.x,null,this.user.name||""))),r.a.createElement(d.m,null),r.a.createElement(d.s,null,r.a.createElement(d.t,{onClick:function(){e.setState({toggleDrawer:!1}),i.go("Users")}},"Usuarios"),this.user.profile.modules.map(function(t){return r.a.createElement(d.t,{onClick:function(){e.setState({toggleDrawer:!1}),i.go(t.reactPath)},key:t.key},t.display)}),r.a.createElement(d.t,{onClick:function(){return t=function(){return e.setState({toggleDrawer:!0})},void(window.confirm("\xbfDeseas cerrar sesi\xf3n?")?(k.clear(),window.location.reload()):t(!1));var t}},"Cerrar Session")))))}}]),t}(n.Component),j=function(e){var t=e.params,a=t.title,n=t.parentView,i=e.navigation;return r.a.createElement("div",{className:"navbar-container",style:{marginBottom:"2rem"}},r.a.createElement(d.a,{position:"fixed",color:"default"},r.a.createElement(d.D,{className:"navbar",variant:"regular"},r.a.createElement(d.q,{className:e.classes.menuButton,onClick:function(){return i.go(n)}},"arrow_back"),r.a.createElement(d.E,{variant:"h6",color:"inherit"},a),r.a.createElement("div",null))))},S=Object(h.withStyles)(function(e){return{root:{width:"100%"},grow:{flexGrow:1},menuButton:{marginRight:20},title:Object(p.a)({display:"none"},e.breakpoints.up("sm"),{display:"block"}),search:Object(p.a)({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(g.fade)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(g.fade)(e.palette.common.white,.25)},marginRight:2*e.spacing.unit,marginLeft:0,width:"100%"},e.breakpoints.up("sm"),{marginLeft:3*e.spacing.unit,width:"auto"}),searchIcon:{width:9*e.spacing.unit,height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit",width:"100%"},inputInput:Object(p.a)({paddingTop:e.spacing.unit,paddingRight:e.spacing.unit,paddingBottom:e.spacing.unit,paddingLeft:10*e.spacing.unit,transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("md"),{width:200}),sectionDesktop:Object(p.a)({display:"none"},e.breakpoints.up("md"),{display:"flex"}),sectionMobile:Object(p.a)({display:"flex"},e.breakpoints.up("md"),{display:"none"})}})(function(e){return void 0===e.params.visible&&(e.params.visible=!0),e.params.visible?"parent"===e.params.type?r.a.createElement(C,e):r.a.createElement(j,e):r.a.createElement("div",null)}),O=a(32),N=r.a.memo(function(e){var t=Object(n.useState)("flex"),a=Object(O.a)(t,2),i=a[0],s=a[1],c=Object(n.useState)("Cargando...."),o=Object(O.a)(c,2),l=o[0],u=o[1];return Object(n.useEffect)(function(){e.show?s("flex"):s("none"),e.title?u(l):u("Cargando....")},[i,l,e]),r.a.createElement("div",{className:"loader",style:{display:i}},r.a.createElement(d.h,{variant:"indeterminate",color:"primary"}),r.a.createElement(d.E,{variant:"caption",style:{marginLeft:20}},l||e.title))},function(e,t){return e===t}),I=a(3),P=a.n(I),D=a(9),L=a(99),T=a(269),_=new(a.n(T).a)("ckUQU!@YtN%8Phtp9tXtC6W96PeV8Kd4mcMpB==Bs9JUK8B=*JKNX!C$K%3a"),A=localStorage;"true"===sessionStorage.getItem("isLogginIn")&&(A=sessionStorage);var B={method:"get",headers:{"Content-Type":"application/json",Accept:"application/json",token:A.getItem("token")}},M=function(){var e="=".repeat((4-E.length%4)%4),t=(E+e).replace(/_/g,"/"),a=window.atob(t);return Uint8Array.from(Object(L.a)(a).map(function(e){return e.charCodeAt(0)}))};function V(){return J.apply(this,arguments)}function J(){return(J=Object(D.a)(P.a.mark(function e(){var t,a,n;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=M(),a=v+"/webpush/subscribe",e.next=4,window.reg.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:t}).catch(function(e){return console.log("Error to subscribe to push manager ".concat(e))});case 4:return n=e.sent,B.body=JSON.stringify(n),B.method="post",e.next=9,fetch(a,B);case 9:window.location.reload();case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}var W=function(){var e=Object(D.a)(P.a.mark(function e(t){var a,n;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(b).concat(t),B);case 3:return a=e.sent,e.next=6,a.json();case 6:return n=e.sent,e.abrupt("return",n);case 10:return e.prev=10,e.t0=e.catch(0),e.t0.message,e.abrupt("return",{error:!0,message:"Servidor fuera de linea"});case 14:case"end":return e.stop()}},e,null,[[0,10]])}));return function(t){return e.apply(this,arguments)}}(),F={subscribeNotificacion:function(e){e.error||Notification.requestPermission().then(function(){var e=Object(D.a)(P.a.mark(function e(t){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("granted"!==t){e.next=3;break}return e.next=3,V();case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},login:function(){var e=Object(D.a)(P.a.mark(function e(t,a,n){var r,i,s;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(b,"/users/login"),{method:"post",body:JSON.stringify({username:t,password:a,autoLogin:n}),headers:{"Content-Type":"application/json",Accept:"application/json"}});case 2:if((r=e.sent).ok){e.next=5;break}return e.abrupt("return",{error:!0,message:r.statusText});case 5:return e.next=7,r.json();case 7:if(!(i=e.sent).error){e.next=10;break}return e.abrupt("return",i);case 10:return s=JSON.stringify({autoLogin:n,_id:i.user._id,avatar:i.user.avatar,profile:i.user.profile,displayName:i.user.name,username:i.user.username,password:n?_.encrypt(a):""}),(A=n?localStorage:sessionStorage).setItem("token",i.token),A.setItem("user",s),A.setItem("isLoggedIn",!0),A.setItem("current-view","Home"),this.subscribeNotificacion(i),e.abrupt("return",i);case 18:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}(),autoLogin:function(){var e=Object(D.a)(P.a.mark(function e(){var t,a,n,r,i;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=JSON.parse(A.getItem("user"))).autoLogin){e.next=3;break}return e.abrupt("return",{error:!0,message:"No se puede regenerar el token"});case 3:return a=t.username,n=_.decrypt(t.password),e.next=7,fetch(b+"/users/login",{method:"post",headers:{"Content-Type":"Application/Json",Accept:"Application/Json"},body:JSON.stringify({username:a,password:n,autoLogin:!0})});case 7:if(!((r=e.sent).status>=400)){e.next=10;break}return e.abrupt("return",console.log(r.statusText));case 10:return e.next=12,r.json();case 12:if(!(i=e.sent).error){e.next=15;break}return e.abrupt("return",i);case 15:return A.setItem("token",i.token),e.abrupt("return",i.token);case 17:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),Upload:function(){var e=Object(D.a)(P.a.mark(function e(t,a){var n;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return B.headers["Content-Type"]="multipart/form-data",B.method="post",B.body=a,e.next=5,W(t);case 5:if(!(n=e.sent).tokenExpired){e.next=13;break}return e.next=9,this.autoLogin();case 9:return B.headers.token=e.sent,e.next=12,W(t);case 12:n=e.sent;case 13:return e.abrupt("return",n);case 14:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),Get:function(){var e=Object(D.a)(P.a.mark(function e(t){var a,n;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return B.method="get",B.body&&delete B.body,e.next=4,W(t);case 4:if(!(a=e.sent).tokenExpired){e.next=18;break}return e.next=8,this.autoLogin();case 8:if(n=e.sent,console.log(n),!n.error){e.next=14;break}return e.abrupt("return",n);case 14:return B.headers.token=n,e.next=17,W(t);case 17:a=e.sent;case 18:return e.abrupt("return",a);case 19:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),Put:function(){var e=Object(D.a)(P.a.mark(function e(t,a){var n,r;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return B.method="put",B.body=JSON.stringify(a),e.next=4,W(t);case 4:if(!(n=e.sent).tokenExpired){e.next=17;break}return e.next=8,this.autoLogin();case 8:if(!(r=e.sent).error){e.next=13;break}return e.abrupt("return",r);case 13:return B.headers.token=r,e.next=16,W(t);case 16:n=e.sent;case 17:return e.abrupt("return",n);case 18:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),Post:function(){var e=Object(D.a)(P.a.mark(function e(t,a){var n,r;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return B.method="post",B.body=JSON.stringify(a),e.next=4,W(t);case 4:if(!(n=e.sent).tokenExpired){e.next=17;break}return e.next=8,this.autoLogin();case 8:if(!(r=e.sent).error){e.next=13;break}return e.abrupt("return",r);case 13:return B.headers.token=r,e.next=16,W(t);case 16:n=e.sent;case 17:return e.abrupt("return",n);case 18:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),Delete:function(){var e=Object(D.a)(P.a.mark(function e(t){var a,n;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return B.method="delete",B.body&&delete B.body,e.next=4,W(t);case 4:if(!(a=e.sent).tokenExpired){e.next=17;break}return e.next=8,this.autoLogin();case 8:if(!(n=e.sent).error){e.next=13;break}return e.abrupt("return",n);case 13:return B.headers.token=n,e.next=16,W(t);case 16:a=e.sent;case 17:return e.abrupt("return",a);case 18:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},q={container:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",position:"fixed"},msg:{color:"grey"}},R=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={open:!1,imageFile:null},a.position=1,a.canvas=null,a.ctx=null,a.img=null,a.canvasRef=function(e){null!==e&&(a.canvas=e,a.ctx=a.canvas.getContext("2d"),a.renderImagePreview())},a.rotate=function(){var e=a.canvas.width,t=a.canvas.height;switch(a.ctx.clearRect(0,0,a.canvas.width,a.canvas.height),a.ctx.save(),a.position){case 0:a.ctx.drawImage(a.img,0,0,e,t),a.position=1;break;case 1:a.ctx.translate(e/2,t/2),a.ctx.rotate(90*Math.PI/180),a.ctx.translate(-t/2,-e/2),a.ctx.drawImage(a.img,0,0,t,e),a.position=2;break;case 2:a.ctx.translate(e/2,t/2),a.ctx.rotate(180*Math.PI/180),a.ctx.translate(-e/2,-t/2),a.ctx.drawImage(a.img,0,0,e,t),a.position=3;break;case 3:a.ctx.translate(e/2,t/2),a.ctx.rotate(270*Math.PI/180),a.ctx.translate(-t/2,-e/2),a.ctx.drawImage(a.img,0,0,t,e),a.position=0;break;default:alert("nothing to di")}a.ctx.restore()},a.handleClose=function(){return a.setState({open:!1})},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentWillReceiveProps",value:function(e){null!==e&&this.setState({open:e.open,imageFile:e.imageFile})}},{key:"renderImagePreview",value:function(){var e=this;if(null!==this.canvas){var t=document.querySelector("#pic");t.src=window.URL.createObjectURL(this.state.imageFile),t.onload=function(){e.img=t,e.ctx=e.canvas.getContext("2d"),e.ctx.drawImage(t,0,0,e.canvas.width,e.canvas.height)}}}},{key:"render",value:function(){var e=this,t=this.state.open;return r.a.createElement(d.i,{open:t,onClose:this.handleClose,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",style:{height:"60vh",width:"80wh"}},r.a.createElement(d.k,{itemRef:"dialog-el"},r.a.createElement("img",{id:"pic",alt:"pc",width:"800",height:"400",style:{display:"none"}}),r.a.createElement("canvas",{ref:this.canvasRef,id:this.props.id,style:{width:"100%",height:"100%"}})),r.a.createElement(d.j,null,r.a.createElement(d.c,{onClick:this.rotate},"Rotar"),r.a.createElement(d.c,{onClick:function(){var t=e.canvas.toDataURL();e.props.onSave(t)}},"Guardar")))}}]),t}(r.a.Component),U=S,G=N,H=function(e){var t=e.date?new Date(e.date):new Date;return t=t.toLocaleString("es-MX"),r.a.createElement(d.s,null,r.a.createElement(d.t,null,r.a.createElement(d.u,null,r.a.createElement(d.b,null,e.clientName[0])),r.a.createElement(d.x,{secondary:t},r.a.createElement(d.E,null,e.clientName))))},z=function(e){return r.a.createElement("span",{className:"fab-fixed"},r.a.createElement(d.n,{color:"inherit","aria-label":"Add",onClick:function(){return e.onClick()}},r.a.createElement(d.q,null,"add")))},$=function(e){return r.a.createElement("div",{style:q.container},r.a.createElement("h5",{style:q.msg},e.message))},X=R,K=function(e){var t="";return r.a.createElement(d.i,{open:e.open,onClose:e.onClose},r.a.createElement(d.l,null,"Nueva contrase\xf1a"),r.a.createElement(d.k,null,r.a.createElement(d.C,{type:"password",label:"Contrase\xf1a",onChange:function(a){t=a.target.value,e.onChange&&e.onChange(a.target.value)}})),r.a.createElement(d.j,null,r.a.createElement(d.c,{onClick:e.onClose},"Cancelar"),r.a.createElement(d.c,{onClick:function(){return e.onSave(t)}},"Cambiar")))},Q=function(e){var t=e.inputs,a=void 0===t?[]:t,n=e.onChange,i=void 0===n?function(){return null}:n,s=e.values,c=void 0===s?{}:s;return r.a.createElement("div",null,a.map(function(e,t){return r.a.createElement(d.C,{key:t+"__"+e.key,value:c[e.key]||"",type:c[e.type||"text"],label:e.label||"Input",onChange:function(a){var n=a.target;return i(e.key,n.value,t)},fullWidth:!0,required:e.required||!1,tabIndex:1,autoComplete:e.autoComplete||"off"})}))},Y=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={show:!1,username:"",password:"",autoLogin:!1},a.login=function(){var e=Object(D.a)(P.a.mark(function e(t){var n,r,i,s,c;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a.setState({show:!0}),n=a.state,r=n.username,i=n.password,s=n.autoLogin,e.next=5,F.login(r,i,s);case 5:if(c=e.sent,a.setState({show:!1}),!c.error){e.next=9;break}return e.abrupt("return",alert(c.message));case 9:window.location.reload();case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.show,n=t.username,i=t.password;return r.a.createElement(d.p,{container:!0,justify:"center",alignItems:"center",style:{height:"100vh"}},r.a.createElement(G,{show:a}),r.a.createElement("form",{onSubmit:this.login},r.a.createElement("div",{className:"bg-login"}),r.a.createElement(d.d,{style:{width:"90%",margin:"auto"}},r.a.createElement(d.g,null),r.a.createElement(d.f,null,r.a.createElement(d.C,{label:"Usuario",fullWidth:!0,value:n||"",onChange:function(t){return e.setState({username:t.target.value})},tabIndex:1}),r.a.createElement(d.C,{label:"Contrase\xf1a",type:"password",fullWidth:!0,value:i||"",onChange:function(t){return e.setState({password:t.target.value})},tabIndex:2})),r.a.createElement(d.e,null,r.a.createElement(d.p,{container:!0},r.a.createElement(d.p,{item:!0,xs:3}),r.a.createElement(d.p,{item:!0,xs:6},r.a.createElement(d.o,{control:r.a.createElement(d.B,{value:!0,color:"primary",onChange:function(t){return e.setState({autoLogin:t.target.checked})}}),label:"Auto Login",tabIndex:3})),r.a.createElement(d.p,{item:!0,xs:3}),r.a.createElement(d.p,{item:!0,xs:12},r.a.createElement(d.c,{fullWidth:!0,variant:"contained",color:"primary",type:"submit"},"Login")))))))}}]),t}(n.Component),Z=function(e){var t=e.client,a=void 0===t?{}:t,n=e.onClose,i=e.open,s=void 0!==i&&i,c=function(e){return window.open("tel:".concat(e))};return r.a.createElement(d.i,{open:s,onClose:n},r.a.createElement(d.l,null,"Elige que numero marcar"),r.a.createElement(d.k,null,r.a.createElement(d.E,{onClick:function(){return c(a.cellphone||"")}},a.cellphone||""),a.phone&&r.a.createElement(d.E,{onClick:function(){return c(a.phone||"")},style:{marginTop:10}},a.phone||"")))},ee=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).watcher=null,a.navigation=a.props.navigation,a.state={clients:[],loading:!0,messageError:"",openPhoneDialog:!1,clientSelected:{}},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.navigation.setNavbarParams({type:"parent",moreMenu:!0,placeholder:"Buscar Clientes",onSearch:function(t){e.setState({loading:!0}),clearTimeout(e.watcher),e.watcher=setTimeout(Object(D.a)(P.a.mark(function a(){var n;return P.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(""!==t){a.next=6;break}return a.next=3,F.Get("/clients/fetch/50/0");case 3:n=a.sent,a.next=9;break;case 6:return a.next=8,F.Get("/clients/search/"+t);case 8:n=a.sent;case 9:if(!n.error){a.next=11;break}return a.abrupt("return",e.setState({loading:!1,messageError:n.message}));case 11:e.setState({loading:!1,clients:n.clients});case 12:case"end":return a.stop()}},a)})),500)}}),this.fetchClients()}},{key:"fetchClients",value:function(){var e=Object(D.a)(P.a.mark(function e(){var t;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.Get("/clients/fetch/50/0");case 2:if(!(t=e.sent).error){e.next=5;break}return e.abrupt("return",this.setState({loading:!1,messageError:t.message}));case 5:this.setState({clients:t.clients,loading:!1});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,a=t.loading,n=t.clients,i=t.messageError,s=t.openPhoneDialog,c=t.clientSelected;return r.a.createElement("div",{className:"container"},r.a.createElement(G,{show:a}),r.a.createElement(Z,{open:s,onClose:function(){e.setState({openPhoneDialog:!1})},client:c}),n.length>0?r.a.createElement(d.s,null,n.map(function(t){return r.a.createElement(d.t,{key:t._id,onClick:function(){e.navigation.go("ClientForm",{action:"update",client:t})}},r.a.createElement(d.u,null,r.a.createElement(d.b,null,t.name[0])),r.a.createElement(d.x,{secondary:t.cellphone},t.name),r.a.createElement(d.w,null,r.a.createElement(d.q,{color:"action",onClick:function(){return e.setState({openPhoneDialog:!0,clientSelected:t})}},"phone")))})):r.a.createElement($,{message:i}),r.a.createElement(z,{onClick:function(){return e.navigation.go("ClientForm",{action:"add"})}}))}}]),t}(r.a.Component),te={baseInputs:[{key:"name",type:"text",label:"Nombre",required:!0},{key:"cellphone",label:"Celular",type:"tel",required:!0},{key:"phone",label:"Telefono",type:"tel"},{key:"address",label:"Direcci\xf3n"},{key:"hood",label:"Colonia"},{key:"county",label:"Municipio"},{key:"state",label:"Estado"},{key:"country",label:"Pais"},{key:"zip",label:"Codigo Postal",type:"number"}],invoices:[{key:"rfc",label:"RFC"},{key:"forma_de_pago",label:"Forma de Pago"},{key:"uso_de_factura",label:"Uso de factura"}]},ae=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).params=a.props.navigation.getParams(),a.state={values:{},loader:!0,fetchError:{status:!1,message:""}},a.handleChange=function(e,t){var n=a.state.values;n[e]=t,a.setState({values:n})},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.navigation;e.setNavbarParams({child:!0,parentView:"Clients",title:"Datos Clientes"}),"update"===e.getParams().action?this.setState({loader:!1,values:this.params.client}):this.setState({loader:!1})}},{key:"handleSubmit",value:function(e){e.preventDefault(),"update"===this.props.navigation.getParams().action?this.updateClient():this.addClient()}},{key:"updateClient",value:function(){var e=Object(D.a)(P.a.mark(function e(){var t,a,n;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.state.values,delete(a={id:t._id,data:t}).data._id,e.next=6,F.Put("/clients",a);case 6:if(!(n=e.sent).error){e.next=9;break}return e.abrupt("return",alert(n.message));case 9:this.props.navigation.go("Clients"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}},e,this,[[0,12]])}));return function(){return e.apply(this,arguments)}}()},{key:"addClient",value:function(){var e=Object(D.a)(P.a.mark(function e(){var t,a;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.state.values,e.next=4,F.Post("/clients",{client:t});case 4:if(!(a=e.sent).error){e.next=7;break}return e.abrupt("return",alert(a.message));case 7:this.props.navigation.go("Clients"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}},e,this,[[0,10]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"container padding-1 margin-1"},this.state.fetchError.status?r.a.createElement($,{message:this.state.fetchError.message}):r.a.createElement("form",{onSubmit:function(t){return e.handleSubmit(t)}},r.a.createElement(d.p,{container:!0,spacing:16},r.a.createElement(G,{show:this.state.loader}),r.a.createElement(d.p,{item:!0,xs:12},r.a.createElement(Q,{values:this.state.values,inputs:te.baseInputs,onChange:this.handleChange})),r.a.createElement(d.p,{item:!0,xs:12},r.a.createElement(d.o,{control:r.a.createElement(d.B,{checked:this.state.values.invoiceInfo||!1,color:"default",value:"invoiceInfo",onChange:function(t){var a=t.target;return e.handleChange("invoiceInfo",a.checked)}}),label:"Datos de factura",tabIndex:1})),r.a.createElement(d.p,{item:!0,xs:12},this.state.values.invoiceInfo&&r.a.createElement(Q,{values:this.state.values,inputs:te.invoices,onChange:this.handleChange})),r.a.createElement(d.p,{xs:12,item:!0},r.a.createElement(d.c,{variant:"contained",color:"inherit",fullWidth:!0,type:"submit"},"Enviar")))))}}]),t}(n.Component),ne=Object(y.a)({flatCard:{padding:".5rem",borderBottomStyle:"solid",borderBottomWidth:1,borderBottomColor:"#e1e1e1",minHeight:"8rem"},mt:{marginTop:".5rem"}});var re=function(e){var t=ne(),a=r.a.useState(e.budget.budgetDescription||""),n=Object(O.a)(a,2),i=n[0],s=n[1],c=r.a.useState(!1),o=Object(O.a)(c,2),l=o[0],u=o[1],m=r.a.useState(e.budget.visited||!1),p=Object(O.a)(m,2),h=p[0],g=p[1],f=function(){return r.a.createElement(d.p,null,r.a.createElement(d.c,{color:"default",disabled:h},h?"Visitado":"Sin Visitar"),r.a.createElement(d.c,{color:"primary",onClick:function(){e.navigation.go("BudgetComments",{budget:e.budget})}},"Comentarios"),r.a.createElement(d.c,{color:"primary",onClick:function(){return u(!0)}},"Editar"))},v=function(){return r.a.createElement(d.p,null,r.a.createElement(d.c,{variant:"contained",color:"primary",onClick:Object(D.a)(P.a.mark(function t(){return P.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F.Put("/budgets/update",{id:e.budget._id,data:{budgetDescription:i,visited:h}});case 2:u(!1);case 3:case"end":return t.stop()}},t)}))},"Guardar"))};return r.a.createElement(d.p,{container:!0,className:t.flatCard},r.a.createElement(d.p,{xs:2,item:!0},r.a.createElement(d.b,null,e.budget.clientName[0])),r.a.createElement(d.p,{xs:10,item:!0},r.a.createElement(d.p,{container:!0},r.a.createElement(d.p,{xs:12,item:!0},r.a.createElement(d.E,{variant:"button"},e.budget.clientName)),r.a.createElement(d.p,{xs:12,item:!0},r.a.createElement(d.E,{variant:"subtitle2",color:"textSecondary"},new Date(e.budget.createDate).toLocaleString("es-MX"))),r.a.createElement(d.p,{xs:12,item:!0,className:t.mt},l?r.a.createElement("div",null,r.a.createElement(d.C,{label:"Editar informaci\xf3n del presupuesto",value:i,rows:"4",variant:"outlined",multiline:!0,fullWidth:!0,onChange:function(e){var t=e.target;return s(t.value)}}),r.a.createElement(d.o,{label:"Visitado",control:r.a.createElement(d.B,{value:"visited",onChange:function(e){var t=e.target;return g(t.checked)},color:"primary",checked:h})})):r.a.createElement(d.p,{container:!0},r.a.createElement(d.p,{item:!0,xs:12},r.a.createElement(d.E,{paragraph:!0},i.split("\n").map(function(e,t){return r.a.createElement("span",{key:e+t},e," ",r.a.createElement("br",null))}))))),r.a.createElement(d.p,{xs:12,item:!0},r.a.createElement(function(){return l?r.a.createElement(v,null):r.a.createElement(f,null)},null)))))},ie=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={budgets:[],show:!0,errorMessage:""},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.navigation.setNavbarParams({type:"parent",title:"Presupuestos",placeholder:"Buscar Presupuesto",onSearch:function(t){e.setState({loading:!0}),clearTimeout(e.watcher),e.watcher=setTimeout(Object(D.a)(P.a.mark(function a(){var n;return P.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(""!==t){a.next=6;break}return a.next=3,F.Get("/budgets/fetch/50/0");case 3:n=a.sent,a.next=9;break;case 6:return a.next=8,F.Get("/budgets/search/"+t);case 8:n=a.sent;case 9:if(!n.error){a.next=11;break}return a.abrupt("return",e.setState({loading:!1,messageError:n.message}));case 11:e.setState({loading:!1,budgets:n.budgets});case 12:case"end":return a.stop()}},a)})),500)}}),this.fetchBudgets()}},{key:"fetchBudgets",value:function(){var e=Object(D.a)(P.a.mark(function e(){var t;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.Get("/budgets/fetch/50/0");case 2:(t=e.sent).error?this.setState({show:!1,errorMessage:t.messange}):this.setState({budgets:t.budgets,show:!1});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"container",style:{padding:".2rem"}},r.a.createElement(d.p,{container:!0,spacing:16,style:{marginBottom:"3rem"}},r.a.createElement(G,{show:this.state.show}),this.state.budgets.map(function(t){return r.a.createElement(d.p,{item:!0,xs:12,key:t._id},r.a.createElement(re,{ctx:e,budget:t}))}).reverse()),r.a.createElement(z,{onClick:function(){return e.props.navigation.go("SelectClient",{parentView:"Budgets",childView:"AddBudget"})}}))}}]),t}(n.Component),se=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={budgets:[],values:{}},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.navigation,t=e.setNavbarParams,a=e.getParams;t({title:"Agregar Presupuestos",child:!0,parentView:"SelectClient",params:{parentView:"Budgets",childView:"AddBudget"}}),this.setState({values:{clientId:a()._id,clientName:a().name,clientCellphone:a().cellphone,budgetDescription:""}})}},{key:"render",value:function(){var e=this,t=this.state.values;return r.a.createElement("div",{className:"container"},r.a.createElement(H,{clientName:t.clientName||""}),r.a.createElement("textarea",{className:"add-budget",rows:"4",placeholder:"Agregar Informaci\xf3n del presupuesto",required:!0,value:t.budgetDescription,onChange:function(a){var n=a.target;t.budgetDescription=n.value,e.setState({values:t})},ref:"textbox"}),r.a.createElement("div",{className:"fab-fixed"},r.a.createElement(d.n,{"ev-target":"add",color:"primary",onClick:Object(D.a)(P.a.mark(function a(){var n;return P.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(""===t.budgetDescription){a.next=9;break}return a.next=3,F.Post("/budgets/save",{budget:t});case 3:if(!(n=a.sent).error){a.next=6;break}return a.abrupt("return",alert(n.message));case 6:e.props.navigation.go("Budgets"),a.next=10;break;case 9:alert("Debe de llenar la informaci\xf3n solicitada");case 10:case"end":return a.stop()}},a)}))},r.a.createElement(d.q,null,"check"))))}}]),t}(n.Component),ce=a(270),oe=a.n(ce)()(v+"/tlacrm",{query:{room:"budgets"}}),le=function(e){return r.a.createElement(d.d,null,r.a.createElement(d.g,{avatar:r.a.createElement(d.b,{src:e.avatar}),title:e.username,subheader:e.createDate}),r.a.createElement(d.f,null,e.comment.split("\n").map(function(e,t){return r.a.createElement(d.E,{key:e+t},e)})))},ue=function(e){if(e.comments.length>0){return e.comments.map(function(e,t){return r.a.createElement(le,{key:e.username+t,username:e.username,comment:e.comment,createDate:(a=e.createDate,void 0===a?"":new Date(a).toLocaleString("es-MX")),avatar:b+"/get-avatar/"+(e.userId||1)});var a}).reverse()}return r.a.createElement("div",null)},me=function(e){var t=setTimeout(function(){return oe.emit("client_stop_typing")},3e3);return r.a.createElement("div",{className:"add-comment-input"},r.a.createElement(d.C,{defaultValue:e.value,label:"Agrega un comentario",onChange:function(){clearTimeout(t),oe.emit("client_typing",{user:e.username}),t=setTimeout(function(){return oe.emit("client_stop_typing")},3e3)},id:"comment-input"}),r.a.createElement(d.q,{style:{marginRight:10,cursor:"pointer"},onClick:function(){var t=document.querySelector("#comment-input").value;if(""===t)return alert("No debes dejar el comentario en blanco");oe.emit("add_commnet",{id:e.budgetId,comment:{comment:t,username:e.username,userId:e.id}}),document.querySelector("#comment-input").value=""}},"send"))},pe=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).store=window.localStorage,a.user={},a.handleTyping="",a.state={typing:"",comment:"",comments:[],clientName:"",budgetDescription:"",createDate:"",typingState:""},a.budget=a.props.navigation.getParams().budget,a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=Object(D.a)(P.a.mark(function e(){var t;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.props.navigation.setNavbarParams({child:!0,title:"Prospectos",parentView:"Budgets"}),this.socketEvents(),e.next=4,F.Get("/budgets/find-one/"+this.budget._id);case 4:if(!(t=e.sent).error){e.next=7;break}return e.abrupt("return",alert(t.message));case 7:this.setState({comments:t.budget.comments||[],clientName:t.budget.clientName,budgetDescription:t.budget.budgetDescription,createDate:t.budget.createDate});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillMount",value:function(){null===this.store.getItem("ev-token")&&(this.store=sessionStorage),this.store=window.localStorage,this.user=JSON.parse(this.store.getItem("user"))}},{key:"socketEvents",value:function(){var e=this;oe.on("client_typing",function(){""===e.state.typingState&&e.setState({typingState:"estan escribiendo un comentario"})}),oe.on("client_stop_typing",function(){return e.setState({typingState:""})}),oe.on("add_comment",function(t){var a=e.state.comments;a.push(t),e.setState({comments:a})})}},{key:"addComment",value:function(){var e=this.state,t=e.budget,a=e.comment,n=t._id;t.comments.push({comment:a,username:this.user.name}),this.setState({budget:t,comment:""}),delete t._id,this.socket.emit("add_comment",{id:n,budget:t})}},{key:"render",value:function(){var e=this.state,t=e.comment,a=e.comments,n=e.clientName,i=e.createDate,s=e.typingState,c=e.budgetDescription;return r.a.createElement(d.p,{container:!0,style:{marginTop:"4rem"}},r.a.createElement(d.p,{item:!0,sm:12,xs:6},r.a.createElement(d.d,{style:{width:"100vw"}},r.a.createElement(d.g,{avatar:r.a.createElement(d.b,null,n[0]),title:n,subheader:i.replace("T"," ")}),r.a.createElement(d.f,null,c.split("\n").map(function(e,t){return r.a.createElement(d.E,{key:e+t},e)})))),r.a.createElement(d.p,{item:!0,sm:12,xl:6,style:{marginTop:"1rem"}},r.a.createElement(d.d,{style:{width:"100vw"}},r.a.createElement(d.g,{avatar:r.a.createElement(d.b,{src:b+"/get-avatar/"+this.user._id}),title:this.user.displayName,subheader:r.a.createElement(me,{value:t,username:this.user.displayName,id:this.user._id,budgetId:this.budget._id})}),r.a.createElement(d.f,null,r.a.createElement(d.p,{item:!0,sm:12,xs:6},r.a.createElement(d.E,{variant:"caption"},s)),r.a.createElement(ue,{comments:a})))))}}]),t}(n.Component),de=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={clients:[],show:!0},a.params=a.props.navigation.getParams(),a.searching=null,a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.navigation.setNavbarParams({title:"Selecciona un cliente",child:!0,parentView:this.params.parentView||"Clients"}),this.fetchClients()}},{key:"fetchClients",value:function(){var e=Object(D.a)(P.a.mark(function e(){var t;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.Get("/clients/fetch/50/0");case 2:if(!(t=e.sent).error){e.next=5;break}return e.abrupt("return",alert(t.message));case 5:this.setState({clients:t.clients,show:!1});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"searchClient",value:function(e){var t=this;clearTimeout(this.searching),this.searching=setTimeout(Object(D.a)(P.a.mark(function a(){var n;return P.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.setState({show:!0}),a.next=3,F.Get("/clients/search/"+e);case 3:if(!(n=a.sent).error){a.next=6;break}return a.abrupt("return",alert(n.message));case 6:t.setState({clients:n.clients,show:!1});case 7:case"end":return a.stop()}},a)})),1e3)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"container"},r.a.createElement(G,{show:this.state.show}),r.a.createElement(d.p,{container:!0,spacing:16},r.a.createElement(d.p,{item:!0,xs:12,style:{padding:"1rem"}},r.a.createElement(d.C,{variant:"standard",type:"search",label:"Buscar Cliente",fullWidth:!0,onChange:function(t){var a=t.target;""===a.value?e.fetchClients():e.searchClient(a.value)}})),r.a.createElement(d.p,{item:!0,xs:12},r.a.createElement(d.s,null,this.state.clients.map(function(t){return r.a.createElement(d.t,{key:t._id,onClick:function(){e.props.navigation.go(e.params.childView,t)}},r.a.createElement(d.x,{secondary:t.cellphone||""},t.name),r.a.createElement(d.v,null,r.a.createElement(d.q,null,"next")))})))))}}]),t}(n.Component),he=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={users:[],error:{status:!1,message:""},loader:!0},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=Object(D.a)(P.a.mark(function e(){var t;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.props.navigation.setNavbarParams({type:"parent",title:"Usuarios",moreMenu:!0,placeholder:"Buscar Cliente"}),e.next=3,F.Get("/users/fetch");case 3:if(void 0!==(t=e.sent)){e.next=6;break}return e.abrupt("return",this.setState({error:{status:!0,message:"Ocurrio un error con el servidor"},loader:!1}));case 6:t.error?this.setState({error:{status:!0,message:t.message},loader:!1}):this.setState({loader:!1,users:t.users});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,a=t.loader,n=t.error,i=t.users;return r.a.createElement(d.p,{container:!0,className:"container",style:{minHeight:"70vh"}},r.a.createElement(d.p,{xs:"auto",md:2,item:!0}),r.a.createElement(d.p,{item:!0,xs:12,md:8},n.status?r.a.createElement($,{message:n.message}):r.a.createElement(d.s,null,i.map(function(t){return r.a.createElement(d.t,{key:t._id,onClick:function(){return e.props.navigation.go("UserForm",{parentView:"Users",user:t,action:"update"})}},r.a.createElement(d.u,null,r.a.createElement(d.b,{src:b+"/get-avatar/"+t._id})),r.a.createElement(d.x,{secondary:t.username},r.a.createElement(d.E,null,t.name)))}))),r.a.createElement(G,{show:a}))}}]),t}(n.Component),ge=a(96),fe=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).params=a.props.navigation.getParams(),a.state={showPreview:!1,values:{},loading:!1,imageFile:null,angle:0,avatarUri:"",openChangePassword:!1},a.imageBase64=null,a.avatarChange=function(e){var t=e.target.files[0],n=Object(ge.a)(a);if(!(t.type.includes("jpeg")||t.type.includes("jpg")||t.type.includes("png")))return alert("No es una imagen o no es un formato soportado (jpg o png)");var r=new Image;r.src=URL.createObjectURL(t),r.onload=function(){n.setState({showPreview:!0,imageFile:t})}},a.handleChange=function(e){var t=a.state.values;t[e.target.getAttribute("name")]=e.target.value,a.setState(function(){return{values:t}})},a.handleSubmit=Object(D.a)(P.a.mark(function e(){var t;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return delete(t={data:a.state.values,avatar:a.imageBase64,id:a.state.values._id}).data._id,e.next=4,F.Put("/users/",t);case 4:a.props.navigation.go(a.params.parentView);case 5:case"end":return e.stop()}},e)})),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.body.style.background="#e1e1e1",this.OnResize(),window.addEventListener("resize",function(){return e.OnResize()}),this.setState({values:this.params.user})}},{key:"componentWillUnmount",value:function(){document.body.style.background="#ffffff",window.removeEventListener("resize",this.OnResize)}},{key:"OnResize",value:function(){window.innerWidth>768?this.props.navigation.setNavbarParams({title:"Profiles",parentView:this.params.parentView,child:!0}):this.props.navigation.setNavbarParams({visible:!1})}},{key:"render",value:function(){var e=this,t=this.state,a=t.imageFile,n=t.showPreview,i=t.loading,s=t.openChangePassword;return r.a.createElement(d.p,{container:!0},r.a.createElement(G,{show:i}),r.a.createElement(X,{open:n,imageFile:a,id:"preview-img",onSave:function(t){e.imageBase64=t,e.refs.avatar.src=t,e.setState({showPreview:!1})}}),r.a.createElement(K,{open:s,onClose:function(){return e.setState({openChangePassword:!1})},onSave:function(){var t=Object(D.a)(P.a.mark(function t(a){return P.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F.Put("/users/update-password",{id:e.params.user._id,password:a});case 2:e.setState({openChangePassword:!1});case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}),r.a.createElement(d.p,{item:!0,xs:12},r.a.createElement("div",{className:"user-profile-banner",id:"user-profile-banner"},r.a.createElement("div",{className:"user-profile-banner-bar"},r.a.createElement(d.q,{style:{color:"#ffffff"},onClick:function(){return e.props.navigation.go(e.params.parentView)}},"arrow_back"),r.a.createElement("input",{type:"file",name:"picture",ref:"file",style:{display:"none"},accept:"image/*",capture:"camera",onChange:this.avatarChange}),r.a.createElement("div",null,r.a.createElement(d.q,{style:{color:"#ffffff"},onClick:function(){return e.setState({openChangePassword:!0})}},"restore"),r.a.createElement(d.q,{style:{color:"#ffffff",marginLeft:".5rem"},onClick:function(){return e.refs.file.click()}},"camera_alt"))),r.a.createElement("img",{id:"avatar",ref:"avatar",onClick:function(){return e.refs.file.click()},src:b+"/get-avatar/"+this.params.user._id,alt:this.state.values.name||"profile"}))),r.a.createElement(d.p,{item:!0,xs:12},r.a.createElement(d.d,null,r.a.createElement(d.f,null,r.a.createElement(d.E,null,"Usuario",r.a.createElement("br",null),this.state.values.username||""),r.a.createElement(d.C,{label:"Nombre",fullWidth:!0,value:this.state.values.name||"",name:"name",onChange:this.handleChange,InputLabelProps:{shrink:!!this.state.values.name}}),r.a.createElement(d.C,{label:"Celular",fullWidth:!0,value:this.state.values.cellphone||"",name:"cellphone",onChange:this.handleChange,type:"text"}),r.a.createElement(d.C,{label:"Correo",fullWidth:!0,value:this.state.values.email||"",onChange:this.handleChange,name:"cellphone"})),r.a.createElement(d.e,null,r.a.createElement(d.c,{variant:"contained",color:"primary",onClick:this.handleSubmit},"Guardar")))))}}]),t}(n.Component),ve=Object(h.withStyles)(function(e){return{buttonTopContainer:{marginLeft:e.spacing.unit}}})(fe),be=function(){return r.a.createElement(d.p,{container:!0},r.a.createElement(d.p,{item:!0,xs:5},"Descripcion"),r.a.createElement(d.p,{item:!0,xs:3},"Cantidad"),r.a.createElement(d.p,{item:!0,xs:2},"Precio"),r.a.createElement(d.p,{item:!0,xs:2},"Subtotal"))},Ee=function(e){return e.jobs.map(function(e,t){return r.a.createElement(d.p,{container:!0,key:t},r.a.createElement(d.p,{item:!0,xs:5},r.a.createElement(d.E,{variant:"caption"},e.trabajo)),r.a.createElement(d.p,{item:!0,xs:3},r.a.createElement(d.E,{variant:"caption"},e.cantidad)),r.a.createElement(d.p,{item:!0,xs:2},r.a.createElement(d.E,{variant:"caption"},"$",parseFloat(e.precio).toLocaleString())),r.a.createElement(d.p,{item:!0,xs:2},r.a.createElement(d.E,{variant:"caption"},"$",(parseFloat(e.cantidad)*parseFloat(e.precio)).toLocaleString())))})},ye=function(e){var t=e.job;return r.a.createElement("div",null,r.a.createElement(d.p,{container:!0},r.a.createElement(d.p,{item:!0,xs:5}),r.a.createElement(d.p,{item:!0,xs:3},r.a.createElement(d.E,{align:"right"},"Subtotal")),r.a.createElement(d.p,{item:!0,xs:1}),r.a.createElement(d.p,{item:!0,xs:3},"$",parseFloat(t.subtotal).toLocaleString())),r.a.createElement(d.p,{container:!0},r.a.createElement(d.p,{item:!0,xs:5}),r.a.createElement(d.p,{item:!0,xs:3},r.a.createElement(d.E,{align:"right"},"Iva")),r.a.createElement(d.p,{item:!0,xs:1}),r.a.createElement(d.p,{item:!0,xs:3},"$",parseFloat(t.iva).toLocaleString())),r.a.createElement(d.p,{container:!0},r.a.createElement(d.p,{item:!0,xs:5}),r.a.createElement(d.p,{item:!0,xs:3},r.a.createElement(d.E,{align:"right"},"Total")),r.a.createElement(d.p,{item:!0,xs:1}),r.a.createElement(d.p,{item:!0,xs:3},"$",parseFloat(t.total).toLocaleString())))},xe=function(e){return e.jobs.map(function(e){return r.a.createElement(d.p,{key:e._id,item:!0,xs:12,style:{marginTop:5}},r.a.createElement(d.d,null,r.a.createElement(d.g,{title:e.client.name,subheader:e.create_date}),r.a.createElement(d.f,null,r.a.createElement(be,null),r.a.createElement(Ee,{jobs:e.jobs}),r.a.createElement(ye,{job:e})),r.a.createElement(d.e,null,r.a.createElement(d.p,{container:!0},r.a.createElement(d.p,{item:!0,xs:9},r.a.createElement(d.E,{variant:"caption"},e.tax&&"El documento contiene iva")),r.a.createElement(d.p,{item:!0,xs:3},r.a.createElement(d.c,{color:"secondary"},"Detalle"))))))})},we=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={jobs:[],errorMsg:"",loading:!0},a.fetchJobs=Object(D.a)(P.a.mark(function e(){var t;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.Get("/jobs/fetch/1");case 2:(t=e.sent).error?a.setState({errorMsg:t.message,loading:!1}):a.setState({jobs:t.jobs,loading:!1});case 4:case"end":return e.stop()}},e)})),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.navigation.setNavbarParams({type:"parent",title:"Trabajos",placeholder:"Buscar Trabajos",onSearch:function(){return null}}),this.fetchJobs()}},{key:"render",value:function(){var e=this,t=this.state,a=t.jobs,n=t.errorMsg,i=t.loading;return r.a.createElement(d.p,{container:!0,className:"container"},r.a.createElement(xe,{jobs:a}),r.a.createElement(G,{show:i}),r.a.createElement(z,{onClick:function(){return e.props.navigation.go("SelectClient",{parentView:"Jobs",childView:"AddJob"})}}),""!==n&&r.a.createElement($,{msg:n}))}}]),t}(r.a.Component),ke=Object(y.a)({appBar:{position:"relative"},title:{marginLeft:"1rem",flex:1},padding:{padding:"1rem"},description:{height:"4rem",marginTop:"1rem"}}),Ce=r.a.forwardRef(function(e,t){return r.a.createElement(d.z,Object.assign({direction:"up",ref:t},e))}),je=function(e){var t=e.subtotal,a=e.iva,n=e.total,i=e.anticipo;return r.a.createElement("div",null,r.a.createElement(d.p,{container:!0},r.a.createElement(d.p,{item:!0,xs:5}),r.a.createElement(d.p,{item:!0,xs:3},r.a.createElement(d.E,{align:"right"},"Subtotal")),r.a.createElement(d.p,{item:!0,xs:1}),r.a.createElement(d.p,{item:!0,xs:3},"$",parseFloat(t).toLocaleString())),r.a.createElement(d.p,{container:!0},r.a.createElement(d.p,{item:!0,xs:5}),r.a.createElement(d.p,{item:!0,xs:3},r.a.createElement(d.E,{align:"right"},"Iva")),r.a.createElement(d.p,{item:!0,xs:1}),r.a.createElement(d.p,{item:!0,xs:3},"$",parseFloat(a).toLocaleString())),r.a.createElement(d.p,{container:!0},r.a.createElement(d.p,{item:!0,xs:5}),r.a.createElement(d.p,{item:!0,xs:3},r.a.createElement(d.E,{align:"right"},"Anticipo")),r.a.createElement(d.p,{item:!0,xs:1}),r.a.createElement(d.p,{item:!0,xs:3},"$",parseFloat(i).toLocaleString())),r.a.createElement(d.p,{container:!0},r.a.createElement(d.p,{item:!0,xs:5}),r.a.createElement(d.p,{item:!0,xs:3},r.a.createElement(d.E,{align:"right"},"Total")),r.a.createElement(d.p,{item:!0,xs:1}),r.a.createElement(d.p,{item:!0,xs:3},"$",(parseFloat(n)-parseFloat(i)).toLocaleString())))},Se=function(e){var t=e.ctx,a=ke(),n=r.a.useState(!1),i=Object(O.a)(n,2),s=i[0],c=i[1],o=r.a.useState({}),l=Object(O.a)(o,2),u=l[0],m=l[1];function p(){m({}),c(!1)}function h(e){var t=e.target.getAttribute("name");u[t]=e.target.value,m(u)}return r.a.createElement("div",null,r.a.createElement(d.c,{color:"inherit",onClick:function(){c(!0)}},"Nuevo"),r.a.createElement(d.i,{fullScreen:!0,open:s,onClose:p},r.a.createElement("div",null,r.a.createElement(d.q,{onClick:p},"close")),r.a.createElement("form",{className:a.padding},r.a.createElement(d.C,{label:"Trabajo",fullWidth:!0,type:"text",onChange:h,name:"trabajo",value:u.trabajo,tabIndex:1}),r.a.createElement(d.C,{label:"Material",fullWidth:!0,type:"text",onChange:h,name:"material",value:u.material,tabIndex:2}),r.a.createElement(d.C,{label:"Cantidad",type:"number",fullWidth:!0,onChange:h,name:"cantidad",value:u.cantidad,tabIndex:3}),r.a.createElement(d.C,{label:"Precio",fullWidth:!0,type:"number",onChange:h,name:"precio",value:u.precio,tabIndex:4}),r.a.createElement(d.C,{label:"Descripcion",multiline:!0,rowsMax:5,fullWidth:!0,variant:"outlined",className:a.description,onChange:h,name:"descripcion",value:u.descripcion,tabIndex:5}),r.a.createElement(d.c,{variant:"contained",color:"primary",onClick:function(){t.addJobToObject(u),p()}},"Agregar"))))},Oe=function(e){var t=e.ctx,a=void 0===t?void 0:t,n=ke(),i=r.a.useState(!1),s=Object(O.a)(i,2),c=s[0],o=s[1];function l(){o(!1)}return r.a.createElement("div",null,r.a.createElement(d.c,{variant:"outlined",color:"primary",fullWidth:!0,onClick:function(){o(!0)}},a.state.values.jobs.length>0?"Mostrar Trabajos":"Agregar Trabajo"),r.a.createElement(d.i,{fullScreen:!0,open:c,onClose:l,TransitionComponent:Ce},r.a.createElement(d.a,{className:n.appBar,color:"default"},r.a.createElement(d.D,null,r.a.createElement(d.q,{onClick:l},"close"),r.a.createElement(d.E,{variant:"h6",className:n.title},"Agregar Trabajo"),r.a.createElement(Se,{ctx:a}))),r.a.createElement(d.s,null,a.state.values.jobs.map(function(e,t){var n=parseFloat(e.cantidad)*parseFloat(e.precio);return n="$"+n.toLocaleString(),r.a.createElement(d.t,{key:e.trabajo+"_"+t},r.a.createElement(d.p,{container:!0},r.a.createElement(d.p,{item:!0,xs:6},e.trabajo),r.a.createElement(d.p,{item:!0,xs:3},n),r.a.createElement(d.p,{item:!0,xs:1}),r.a.createElement(d.p,{item:!0,xs:2},r.a.createElement(d.q,{style:{cursor:"pointer"},onClick:function(){return a.quitJobToObject(t)}},"delete"))))}))))},Ne=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).params={},a.state={values:{iva:0,jobs:[],total:0,tax:!1,anticipo:0,subtotal:0,payments:[]}},a.handleChange=function(e,t){var n=a.state.values;n[e]=t,a.setState({values:n})},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.navigation,t=e.setNavbarParams,a=e.getParams;this.params=a(),t({title:"Agregar Trabajo",child:!0,parentView:"SelectClient",params:{parentView:"Jobs",childView:"AddJob"}}),this.calculateTax()}},{key:"calculateTax",value:function(){var e=this.state.values;if(e.tax){var t=.16*parseFloat(e.subtotal);this.handleChange("iva",t)}else this.handleChange("iva",0)}},{key:"addJobToObject",value:function(e){var t=this.state.values;t.jobs.push(e),this.setState(t)}},{key:"quitJobToObject",value:function(e){var t=this.state.values;t.jobs.splice(e,1),this.setState(t)}},{key:"render",value:function(){var e=this,t=this.state.values;return r.a.createElement("div",{className:"container"},r.a.createElement(d.p,{item:!0,xs:12},r.a.createElement(d.d,null,r.a.createElement(d.g,{title:this.params.name||"",subheader:this.params.cellphone||""}),r.a.createElement(d.f,null,r.a.createElement(d.p,{container:!0},r.a.createElement(d.p,{item:!0,xs:12},r.a.createElement(d.C,{label:"Anticipo",type:"number",fullWidth:!0,tabIndex:1,onChange:function(t){var a=t.target;return e.handleChange("anticipo",a.value)}})),r.a.createElement(d.p,{item:!0,xs:12,style:{marginTop:20}},r.a.createElement(Oe,{ctx:this})),r.a.createElement(d.p,{item:!0,xs:12,style:{marginTop:20}},r.a.createElement(d.o,{control:r.a.createElement(d.B,{checked:t.tax||!1,color:"default",value:"tax",onChange:function(t){var a=t.target;e.handleChange("tax",a.checked),e.calculateTax()}}),label:"Calcular IVA",tabIndex:1})),r.a.createElement(d.p,{item:!0,xs:12,style:{marginTop:20}},r.a.createElement(je,{subtotal:t.subtotal,iva:t.iva,total:t.total,anticipo:t.anticipo})))),r.a.createElement(d.e,null,r.a.createElement(d.c,{variant:"contained",color:"primary",fullWidth:!0},"Guardar")))))}}]),t}(n.Component);function Ie(e){return Object(n.useEffect)(function(){e.navigation.setNavbarParams({type:"parent",title:"Inicio"})}),r.a.createElement("div",null,"Home")}var Pe=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={views:{Jobs:we,Home:Ie,Login:Y,Users:he,AddJob:Ne,Budgets:ie,Clients:ee,UserForm:ve,AddBudget:se,ClientForm:ae,SelectClient:de,BudgetComments:pe},currentView:"UserForm",params:{},loggedIn:!1,isMobile:!1,navbarParams:{}},a.store=localStorage,a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){this.breakPoints(),null===this.store.getItem("isLoggedIn")&&(this.store=sessionStorage),"true"===this.store.getItem("isLoggedIn")&&this.setState({loggedIn:!0,currentView:this.store.getItem("current-view")})}},{key:"breakPoints",value:function(){var e=window.innerWidth;/Mobile/.test(navigator.userAgent)?this.setState({isMobile:!0}):e>768&&this.setState({isMobile:!0})}},{key:"render",value:function(){var e=this,t=this.state,a=t.views,n=t.currentView,i=t.isMobile,s=a[n],c={go:function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.store.setItem("current-view",t),e.store.setItem("params",JSON.stringify(a)),e.setState({currentView:t,params:a})},setNavbarParams:function(t){return e.setState({navbarParams:t})},isMobile:i,getParams:function(){var e={};return e=localStorage.getItem("params")?localStorage.getItem("params"):sessionStorage.getItem("params"),JSON.parse(e)}};return this.state.loggedIn?r.a.createElement("div",null,r.a.createElement(U,{navigation:c,params:this.state.navbarParams}),r.a.createElement(s,{navigation:c})):r.a.createElement(Y,null)}}]),t}(n.Component),De=(a(607),a(608),Object(D.a)(P.a.mark(function e(){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!("serviceWorker"in navigator)){e.next=6;break}return e.next=3,navigator.serviceWorker.register("sw.js",{scope:"/tlacrm/"}).catch(function(e){return console.log("Error when try to register service worker, ".concat(e))});case 3:window.reg=e.sent,e.next=7;break;case 6:console.log("Service Worker is not supported");case 7:case"end":return e.stop()}},e)})));De(),s.a.render(r.a.createElement(Pe,null),document.getElementById("root"))}},[[328,1,2]]]);
//# sourceMappingURL=main.45c3283e.chunk.js.map